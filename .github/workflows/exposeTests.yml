name: Expose tests
on: 
  workflow_call

jobs:
      
    ExposeTest:
        runs-on: ubuntu-latest
        steps:
            - name: Download sources
              uses: actions/checkout@v3
              with:
                repository: ${{ github.event.pull_request.head.repo.full_name }}
                ref: ${{ github.event.pull_request.head.ref }}
            - name: Get green it report zip
              uses: actions/download-artifact@v3
              with:
                name: green-it-report
                path: /home/runner/work/output
            - name: copy artifact into repo
              run: cp -r /home/runner/work/output /home/runner/work/HyperGlosae/HyperGlosae/tests/greenIT/output
            - name: commit artifact
              uses: EndBug/add-and-commit@v9
              with:
                add: "*"
                default_author: github_actions
                message: "WORKFLOW : Add green IT Analysis HTML file output"
                push: origin/PE_test_greenframe
            - name: Set CURRENT_BRANCH
              run: echo "CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)" >> $GITHUB_ENV
            - name: create link to go to html file exposition
              run:
                echo "https://htmlpreview.github.io/?https://github.com/vallhallalm/HyperGlosae/${{env.CURRENT_BRANCH}}/tests/greenIT/output/global.html"
        
    